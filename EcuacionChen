//bibliotecas
#include <stdio.h>
#include <math.h>

#define PI 3.14159265359 //constante para el calculo de PI
#define LAMINAR 2100.00 //Umbral laminar
#define TURBULENTO 8100.00 //Umbral Turbulento

//funciones auxiliares
void   mensaje(void);
double leerDato(void);
double calcularVelocidad(double caudal, double diametro);
double calculoReynolds(double densidad, double viscosidad, double velocidad, double diametro);
int    calculoFlujo(double reynolds);
double calculoRugosidadRelativa(double rugosidadAb, double diametro);
double calculoRugosidadRelativa(double rugosidadAb, double diametro);
double factorRozamiento(int control,double reynolds, double rugosidadRe);


int main(void) {
    //valores de entrada
    double caudal;//almacena el valor de caudal
    double diametro;//almacena el valor de diametro
    double densidad;//almacena el valor de densidad
    double viscosidad;//almacena el valor de viscosidad
    double rugosidadAb;//almacena el valor de la rugosidad absoluta
    

    //valores de salida
    double velocidad;//almacena el valor de velociad
    double reynolds;//almacena el valor de reynolds
    int    control;//variable para el control del fluido y calculo de F
    double rugosidadRe;//almacena el valor de la rugosidad absoluta
    double factor;//almacena el valor del factor de rozamiento

   do{
        mensaje();

        //Caudal
        printf("Caudal[m3/s]:");
        caudal=leerDato();

        //Densidad
        printf("Densidad[Kg/m3]:");
        densidad=leerDato();

        //Viscosidad
        printf("Viscosidad[Kg/ms]:");
        viscosidad=leerDato();

        //Diametro
        printf("Diametro[m]:");
        diametro=leerDato();

        //Rugosidad
        printf("Rugosidad absoluta[m]:");
        rugosidadAb=leerDato();

        //velocidad
        velocidad=calcularVelocidad(caudal,diametro);

        //reynolds
        reynolds=calculoReynolds(densidad,viscosidad,velocidad,diametro);  

        //rugosidad Relativa
        rugosidadRe=calculoRugosidadRelativa(rugosidadAb,diametro);

            
        //Mensaje por pantalla
        //velocidad
        printf("\n\nVelocidad[m/s]: %.3lf \n",velocidad);

        //Reynolds
        printf("Reynolds: %.3lf",reynolds);

        //tipo de flujo
        control=calculoFlujo(reynolds);

        //rugosidadRe
         printf("Rugosidad relativa: %.6lf\n",rugosidadRe);

         //factor de rozamiento
        factor=factorRozamiento(control,reynolds,rugosidadRe);
        printf("Factor rozamiento: %.6lf\n",factor);


        printf("\n      ----------------------------------      \n\n");

       
    }while(1);
    return 0;
}

/*saca por pantalla mensaje inicial */
void mensaje(void){
    printf("Programa para el calculo de la velocidad, numero de Reynold, tipo de fluido y f.\nIntroduzca los valores en notacion natural.\n\n");
}

/*lee el ddato de entrada
tipo double*/
double leerDato(void){

    double dato;
    scanf("%lf", &dato);
    return dato;
}

/*caclula la velocidad del fluido
tipo double*/
double calcularVelocidad(double caudal, double diametro)
{
       return (caudal/(PI*pow(diametro,2)/4));
}

/*caclula el numero de reynolds
tipo double*/
double calculoReynolds(double densidad, double viscosidad, double velocidad, double diametro){
    return ((velocidad*diametro*densidad)/viscosidad);
}

/**caclulo del tipo de flujo */
int calculoFlujo(double reynolds){
    int n=0; //variable de control

    if(reynolds < LAMINAR){
       printf("  ->Flujo laminar\n");
       n=1;

    }else if((LAMINAR <= reynolds) && (reynolds < TURBULENTO)){

        printf("  ->Flujo de transicion\n");
        n=2;
    }
    else{
        printf("  ->Flujo turbulento\n");
        n=3;
    }    

    return n;
}

/*caclula la rugosidad relativa
tipo double*/
double calculoRugosidadRelativa(double rugosidadAb, double diametro){
    return (rugosidadAb/diametro);
}

/*caclulo factor de rozamiento
tipo double*/
double factorRozamiento(int control,double reynolds, double rugosidadRe){
    double factor;//variable para almacenar el factor de rozamiento
    //auxiliares
    double logaritmo1=0.0;
    double logaritmo2=0.0;  


    if(control == 1){
        factor= (16/reynolds);        
        
    }else if((control == 2) || (control == 3)){

        logaritmo1=log10((((1/2.8257)*(pow(rugosidadRe,1.1098))))+(5.8506/(pow(reynolds,0.8981))));
        logaritmo2=-2*log10((rugosidadRe/3.7065)-(5.0452*(logaritmo1/reynolds)));
        factor=(1/(pow(logaritmo2,2)));

    } else{
        printf("Error factor de Rozamiento.\n");
        factor=0;
    }

    return factor;
}
